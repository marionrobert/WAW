<%= link_to products_path do%>
<div>
<%if Shop.first.banner.key%>
  <div class="banner" style="background-image: url('<%= cl_image_path Shop.first.banner.key %>')">
<%else %>
  <div class="banner nobanner">
<%end%>
    <div class="container">
      <div class="bannertextfield">
          <h1 class="bannerh1"><%= Shop.first.name%></h1>
          <h3 class="bannerh3"><%= Shop.first.description%></h3>
      </div>
    </div>
  </div>
</div>
<%end%>
<div class="mobileonly">
  <%=link_to products_path do%>
    <button class="btn btn-primary btnbanner">
    Accédez aux Produits
    </button>
  <%end%>
</div>

<% @products = Product.where("discount_price_cents > 0")%>
<div class="producthomecontainer" data-controller="favorites">
  <% promomax = []%>
  <% @products.each do |product|%>
    <% promomax << (100-((product.discount_price_cents).to_f / (product.price_cents).to_f)*100).round(0)%></span>
  <%end%>
  <h2 class="carrousselh2">Les articles en promotions - Jusqu'à <span style="color:white;background:red;padding:0.4vh 0.4vw;"><i>- <%=promomax.max%> %</i></span></h2>
  <div style="display:flex;">
    <div class="wrapperhomepage">
      <% @products.each do |product| %>
        <%#if product.discount_price_cents > 0%>
          <%= render "shared/#{Shop.first.card}", product: product%>
        <%#end%>
      <%end%>
    </div>
  </div>

  <h2 class="carrousselh2">Découvrez les derniers tendances</h3>
  <div style="display:flex;">
    <div class="wrapperhomepage">
      <% @products = Product.last(15)%>
      <% @products.each do |product| %>
        <%= render "shared/#{Shop.first.card}", product: product%>
      <%end%>
    </div>
  </div>


  <h2 class="carrousselh2">Découvrez les nouveautés du magasin !</h1>
  <div class="row d-flex justify-content-center"
       style="width:100%;margin: 0 auto" >
    <% @products.each do |product| %>
      <%= render "shared/#{Shop.first.card}", product: product%>
    <% end %>
  </div>

  <h2 class="carrousselh2">Produits par catégories</h3>
  <div class="catwrapperoddevencontent">
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
            <% if index.odd? %>
              <div class="oddcategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                <h3 class="catvignettename"><%= category.name %></h3>
              </div>
            <% end%>
          <%end%>
      </div>
    </div>
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
            <% if index.even? %>
              <div class="evencategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                <h3 class="catvignettename"><%= category.name %></h3>
              </div>
            <% end%>
          <%end%>
      </div>
    </div>
  </div>

  <div style="margin-bottom:5vh;">
    <h2 class="carrousselh2">Découvrez les derniers articles publiés !</h1>
      <%= render "blogposts/blogpostoddeven"%>
  </div>
</div>
