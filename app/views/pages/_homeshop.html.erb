<%= link_to products_path do%>
<div>
<%if Shop.first.banner.key%>
  <div class="banner" style="background-image: url('<%= cl_image_path Shop.first.banner.key %>')">
<%else %>
  <div class="banner nobanner">
<%end%>
    <div class="container">
      <div class="bannertextfield">
          <h1 class="bannerh1"><%= Shop.first.name%></h1>
          <h3 class="bannerh3"><%= Shop.first.description%></h3>
      </div>
    </div>
  </div>
</div>
<%end%>
<div class="mobileonly d-flex justify-center" style="display: flex;justify-content: center;">
  <%=link_to products_path do%>
    <button class="btn btn-info btnbanner">
    Accédez aux Produits
    </button>
  <%end%>
</div>


<div class="producthomecontainer" data-controller="favorites">
  <h2 class="carrousselh2">Les articles en promotions - Jusqu'à <span style="color:white;background:red;padding:0.4vh 0.4vw;"><i>- <%=@promo_max%> %</i></span></h2>
<%# CAROUSELGROUP FONCTIONNANT EN JAVASCRIPT SANS STIMULUS %>
<div class="carouselgroup-container">
  <div class="carouselgroup" id="carousel">
    <div class="carouselgroup-content">
      <div class="carouselgroup-item">
        <% @products_with_discount.first(5).each do |product| %>
          <%= render "shared/#{Shop.first.card}", product: product%>
        <%end%>
      </div>
      <div class="carouselgroup-item">
        <% if @products_with_discount.present? && @products_with_discount.slice(6, 5).present? %>
          <% @products_with_discount.slice(6, 5).each do |product| %>
            <%= render "shared/#{Shop.first.card}", product: product %>
          <% end %>
        <% else %>
          <p>Aucun produit en promotion pour le moment.</p>
        <% end %>
      </div>
      <div class="carouselgroup-item">
        <% if @products_with_discount.present? && @products_with_discount.slice(11, 5).present? %>
          <% @products_with_discount.slice(11, 5).each do |product| %>
            <%= render "shared/#{Shop.first.card}", product: product %>
          <% end %>
        <% else %>
          <p>Aucun produit en promotion pour le moment.</p>
        <% end %>
      </div>
    </div>
  </div>
  <button class="carouselgroup-button prev"><i class="fa-solid fa-angles-left"></i></button>
  <button class="carouselgroup-button next"><i class="fa-solid fa-angles-right"></i></button>
</div>
<%# FIN DU CAROUSELGROUP FONCTIONNANT EN JAVASCRIPT SANS STIMULUS %>

<h2 class="carrousselh2">Découvrez les derniers tendances</h3>
  <div class="carouselgroup-container">
    <div class="carouselgroup" id="carousel">
      <div class="carouselgroup-content">
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.first(5).present? %>
            <% @last_products.first(5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.first(11)[6..10].present? %>
            <% @last_products.first(11)[6..10].each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.last(5).present? %>
            <% @last_products.last(5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
      </div>
    </div>
    <button class="carouselgroup-button prev"><i class="fa-solid fa-angles-left"></i></button>
    <button class="carouselgroup-button next"><i class="fa-solid fa-angles-right"></i></button>
  </div>



  <h2 class="carrousselh2">Aperçu des produits en stock !</h1>
  <div class="d-flex justify-content-center" style="flex-flow:wrap;width:100%;margin: 0 auto" data-controller="favorites" >
    <% @products_in_stock.each do |product| %>
      <%= render "shared/#{Shop.first.card}", product: product%>
    <% end %>
  </div>

  <h2 class="carrousselh2">Produits par catégories</h3>
  <div class="catwrapperoddevencontent">
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
          <%=link_to category_path(category) do%>
            <% if index.odd? %>
              <% if category.photos.first %>
                <div class="oddcategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                  <h3 class="catvignettename"><%= category.name %></h3>
                </div>
              <% else %>
                <div class="oddcategory" style="background-image: url('https://images.unsplash.com/photo-1528027656671-6d156f4f1f48?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1941&q=80');">
                  <h3 class="catvignettename"><%= category.name %></h3>
                </div>
              <% end %>
            <% end%>
          <%end%>
        <%end%>
      </div>
    </div>
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
          <%=link_to category_path(category) do%>
            <% if index.even? %>
              <% if category.photos.first %>
                  <div class="evencategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                    <h3 class="catvignettename"><%= category.name %></h3>
                  </div>
                <% else %>
                  <div class="evencategory" style="background-image: url('https://images.unsplash.com/photo-1528027656671-6d156f4f1f48?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1941&q=80');">
                    <h3 class="catvignettename"><%= category.name %></h3>
                  </div>
                <% end %>
            <% end%>
          <%end%>
        <%end%>
      </div>
    </div>
  </div>




  <div style="margin-bottom:5vh;">
    <h2 class="carrousselh2">Découvrez les derniers articles publiés !</h1>
      <%= render "blogposts/blogpostoddeven"%>
  </div>
</div>
