<%= link_to products_path do%>
<div>
<%if Shop.first.banner.key%>
  <div class="banner" style="background-image:radial-gradient(circle, rgba(193,193,193,0.23012955182072825) 0%, rgba(17,17,17,0.49343487394957986) 45%, rgba(52,52,52,0.7707457983193278) 71%), url('<%= cl_image_path Shop.first.banner.key %>');">
<%else %>
  <div class="banner nobanner">
<%end%>
    <div class="container">
      <div class="bannertextfield">
          <h1 class="bannerh1"><%= Shop.first.name%></h1>
          <h3 class="bannerh3"><%= Shop.first.description%></h3>
    <button class="btnbanner">
    Accédez aux Produits
    </button>
      </div>
    </div>
  </div>
</div>
<%end%>
<div class="mobileonly d-flex justify-center" style="display: flex;justify-content: center;">
  <%=link_to products_path do%>
  <%end%>
</div>



<section>
  <div style="height:90vh;width:100vw;position:relative;margin-top:10vh;overflow-x: hidden;">
    <div id="scroll_left" style="height:50px;width:50px;position:absolute;left:0;top:50%;border:2px solid red;background:yellow;z-index:5">
      <i class="fa-regular fa-circle-left" style="height:100%;width:100%;color:black"></i>
    </div>
    <div id="carouselclickable" style="height:90vh;position:absolute;left:0;top:0;display:flex;">
      <% @products_with_discount.each do |product| %>
        <div class="cardcarousel">
          <%= render "shared/#{Shop.first.card}", product: product %>
        </div>
      <% end %>
    </div>
    <div id="scroll_right" style="height:50px;width:50px;position:absolute;right:0;top:50%;border:2px solid red;background:yellow;z-index:5">
      <i class="fa-regular fa-circle-right" style="height:100%;width:100%;color:black"></i>
    </div>
  </div>
</section>













<div class="producthomecontainer" data-controller="favorites">
  <h3 class="carrousselh2">Les articles en promotions - Jusqu'à <span style="color:white;background:grey;padding:0.4vh 0.4vw;"><i>- <%=@promo_max%> %</i></span></h3>
<%# CAROUSELGROUP FONCTIONNANT EN JAVASCRIPT SANS STIMULUS %>
<%if @products_with_discount.count.positive?%>
  <div class="carouselgroup-container">
    <div class="carouselgroup" data-controller="carousel">
      <div class="carouselgroup-content">
        <div class="carouselgroup-item">
          <% if @products_with_discount.present? && @products_with_discount.first(5).present? %>
            <% @products_with_discount.first(5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product%>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @products_with_discount.present? && @products_with_discount.slice(6, 5).present? %>
            <% @products_with_discount.slice(5, 5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @products_with_discount.present? && @products_with_discount.slice(11, 5).present? %>
            <% @products_with_discount.slice(10, 5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
      </div>
    </div>
    <button class="carouselgroup-button prev" data-action="click->carousel#prev"><i class="fa-solid fa-angles-left"></i></button>
    <button class="carouselgroup-button next" data-action="click->carousel#next"><i class="fa-solid fa-angles-right"></i></button>
  </div>
<%end%>
<%# FIN DU CAROUSELGROUP FONCTIONNANT EN JAVASCRIPT SANS STIMULUS %>

<h2 class="carrousselh2">Découvrez les derniers tendances</h3>

  <div class="carouselgroup-container">
    <div class="carouselgroup" data-controller="carousel">
      <div class="carouselgroup-content">
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.first(5).present? %>
            <% @last_products.first(5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.first(11)[6..10].present? %>
            <% @last_products.first(11)[6..10].each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
        <div class="carouselgroup-item">
          <% if @last_products.present? && @last_products.last(5).present? %>
            <% @last_products.last(5).each do |product| %>
              <%= render "shared/#{Shop.first.card}", product: product %>
            <% end %>
          <% else %>
            <p>Aucun produit en promotion pour le moment.</p>
          <% end %>
        </div>
      </div>
    </div>
    <button class="carouselgroup-button prev" data-action="click->carousel#prev"><i class="fa-solid fa-angles-left"></i></button>
    <button class="carouselgroup-button next" data-action="click->carousel#next"><i class="fa-solid fa-angles-right"></i></button>
  </div>



  <h2 class="carrousselh2">Aperçu des produits en stock !</h1>
  <div class="d-flex justify-content-center" style="flex-flow:wrap;width:100%;margin: 0 auto" data-controller="favorites" >
    <% @products_in_stock.each do |product| %>
      <%= render "shared/#{Shop.first.card}", product: product%>
    <% end %>
  </div>

  <h2 class="carrousselh2">Produits par catégories</h3>
  <div class="catwrapperoddevencontent">
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
          <%=link_to category_path(category) do%>
            <% if index.odd? %>
              <% if category.photos.first %>
                <div class="oddcategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                  <h3 class="catvignettename"><%= category.name %></h3>
                </div>
              <% else %>
                <div class="oddcategory" style="background-image: url('https://images.unsplash.com/photo-1528027656671-6d156f4f1f48?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1941&q=80');">
                  <h3 class="catvignettename"><%= category.name %></h3>
                </div>
              <% end %>
            <% end%>
          <%end%>
        <%end%>
      </div>
    </div>
    <div style="display:flex">
      <div class="catwrapperhomepage">
        <% @categories.each_with_index do |category, index| %>
          <%=link_to category_path(category) do%>
            <% if index.even? %>
              <% if category.photos.first %>
                  <div class="evencategory" style="background-image: url('<%= cl_image_path category.photos.first.key %>');">
                    <h3 class="catvignettename"><%= category.name %></h3>
                  </div>
                <% else %>
                  <div class="evencategory" style="background-image: url('https://images.unsplash.com/photo-1528027656671-6d156f4f1f48?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1941&q=80');">
                    <h3 class="catvignettename"><%= category.name %></h3>
                  </div>
                <% end %>
            <% end%>
          <%end%>
        <%end%>
      </div>
    </div>
  </div>

  <section style="margin-bottom:5vh;">
    <h2 class="carrousselh2">Découvrez les derniers articles publiés !</h1>
      <%= render "blogposts/blogpostoddeven"%>
  </section>
</div>
