<%# searchbar %>
<div class="main-bg">
  <div class="container" , style="margin-top:10vh">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-8 col-lg-6">
        <%= form_with url: products_path, method: :get, class: "d-flex pt-5 py-5" do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          style: "font-size:x-large",
          placeholder: "rechercher un produit"
        %>
        <%= submit_tag "Valider", class: "btn btn-primary p-2", style: "font-size:x-large;"%>
        <% end %>
      </div>
    </div>
  </div>
                              <%# affichage des produits %>
  <div class="container">
    <h1 class="mb-5 text-center">Produits disponibles</h1>
    <div class="row d-flex justify-content-center">
        <% @products.each do |product| %>
          <div class="col-sm-9 col-md-6 col-lg-4 col-xl-3 mb-4">
            <div class="radius-bottom">
              <div class="card-trip radius-top" style="box-shadow: 5px 5px 5px rgb(211,211,211);">
                <% if product.photos.attached? %>
                  <%= cl_image_tag product.photos.first.key, height: 300, width: 400, crop: :fill %>
              </div>
                <%else %>
                  <img class="card-color card-image" src="https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg" alt="no_images_available" >
              </div>
                <% end %>
              <div class="card-trip-infos card-color radius-bottom" style="box-shadow: 5px 5px 5px rgb(211,211,211)">
                <div>
                    <h3 style="padding-top:2vh;margin-left:2vh;"><%= product.name %></h3>
                  <%if product.description.length > 90 %>
                    <p style="height: 6vh;margin-left:2vh;font-size:smaller;"><%= product.description.first(120)%>[...]</p>
                  <%else%>
                    <p style="height: 6vh;margin-left:2vh;font-size:smaller;"><%= product.description%></p>
                  <%end%>
                </div>
                  <div style="text-align:right">
                    <%if humanized_money_with_symbol(product.price).include?(",") %>
                      <span style="text-align:end;font-weight:bolder;font-size:24px"><%= humanized_money_with_symbol(product.price)[/^(.+?),/]%></span>
                      <span style="text-align:end;font-weight:bolder;font-size:12px; position:relative;bottom:8px;left:-8px"><%= humanized_money_with_symbol(product.price).last(2)%> ttc</span>
                    <%else %>
                      <span style="text-align:right;font-weight:bolder;font-size:24px"><%= humanized_money_with_symbol(product.price)%>,</span><span style="text-align:end;font-weight:bolder;font-size:12px; position:relative;bottom:8px;left:-4px">  00 ttc</span>
                    <%end%>
                  </div>
                  <div class="d-flex justify-content-center">
                    <span><%= button_to "ajouter au panier", line_items_path(product_id: product), class:"btn btn-warning" %></span>
                    <span><%= link_to "Plus de dÃ©tails", product_path(product), class: "btn btn-primary mt-2 mb-2" %></span>
                  </div>

              </div>
            </div>
          </div>
        <% end %>
      </div>
  </div>
</div>
