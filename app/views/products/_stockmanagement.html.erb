<div class="container" , style="margin-top:10vh;">
  <h1 class="mb-5 text-center">Gestion du stock</h1>
  <table>
    <thead>
      <tr>
        <th class="col-2", colspan="1", style="background:rgba(255,255,255,0.4);">images</th>
        <th class="col-6", colspan="1", style="background:rgba(255,255,255,0.4);">References</th>
        <th class="col-1", colspan="1", style="background:rgba(255,255,255,0.4);">Quantit√©</th>
        <th class="col-1", colspan="1", style="background:rgba(255,255,255,0.4);">Prix</th>
        <th class="col-1", colspan="1", style="background:rgba(255,255,255,0.4);">Prix promo</th>
        <th class="col-1", colspan="1", style="background:rgba(255,255,255,0.4);">Action</th>
      </tr>
    </thead>
    <tbody>
      <% @products.each do |product| %>
        <div class="row">
          <tr>
            <td>
              <div >
              <%if product.photos.attached?%>
                <%= cl_image_tag product.photos.first.key, style:"max-height:80px" %>
              <%else%>
                <%= image_tag("https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg", alt: "Pas d'image disponible", style:"max-height:100px")  %>
              <%end%>
              </div>
            </td>
            <td class="col-6" style="text-align:left"><%= product.name %><br>
            <p style="margin-left:20px;text-decoration"><i><%= product.sku %></i></p></td>

            <td class="col-1" style="text-align:right">
            <%= product.stock_quantity %><br>
            <%= simple_form_for(product) do |product| %>
            <%= product.error_notification %>
            <%= product.error_notification message: product.object.errors[:base].to_sentence if product.object.errors[:base].present? %>
            <div class="form-inputs" >
              <%= product.input :stock_quantity, input_html: { min: '0'} %>
            </div>
            <div class="form-actions">
              <%= button_tag( :style => "background:rgba(0,0,0,0);border:none;color:black;") do %>
              <i class="fa-regular fa-circle-check"></i>
              <% end %>
            </div>
            <%end%>
            </td>

            <td class="col-1" style="text-align:right">
            <% prix = humanized_money_with_symbol(product.price_cents / 100.00) + " " + humanized_money_with_symbol(product.price_cents / 100.00).first%>
            <%= prix.slice(1..50) %><br>            <%= simple_form_for(product) do |product| %>
            <%= product.error_notification %>
            <%= product.error_notification message: product.object.errors[:base].to_sentence if product.object.errors[:base].present? %>
            <div class="form-inputs" >
              <%= product.input :price_cents, input_html: { min: '0'} %>
            </div>
            <div class="form-actions">
              <%= button_tag( :style => "background:rgba(0,0,0,0);border:none;color:black;") do %>
              <i class="fa-regular fa-circle-check"></i>
              <% end %>
            </div>
            <%end%>
            </td>

            <td class="col-1" style="text-align:right">
            <% prixpromo = humanized_money_with_symbol(product.discount_price_cents / 100.00) + " " + humanized_money_with_symbol(product.discount_price_cents / 100.00).first%>
            <%= prixpromo.slice(1..50) %><br>
            <%= simple_form_for(product) do |product| %>
            <%= product.error_notification %>
            <%= product.error_notification message: product.object.errors[:base].to_sentence if product.object.errors[:base].present? %>
            <div class="form-inputs" >
              <%= product.input :discount_price_cents, input_html: { min: '0'} %>
            </div>
            <div class="form-actions">
              <%= button_tag( :style => "background:rgba(0,0,0,0);border:none;color:black;") do %>
              <i class="fa-regular fa-circle-check"></i>
              <% end %>
            </div>
            <%end%>
            </td>

            <td class="col-1">
              <div style="display:flex;justify-content: space-around;">
                <%= link_to edit_product_path(product) do %>
                  <i class="fa-solid fa-eraser"></i>
                <%end%>
                 <%= link_to product, data: { turbo_method: :delete } do %>
                  <i class="fa-solid fa-trash"></i>
                <%end%>
              </div>
            </td>
          </tr>
        </div>
      <% end %>
    </tbody>
  </table>
</div>
